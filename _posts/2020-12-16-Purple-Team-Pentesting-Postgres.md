---
layout: post
title: "Purple Team PostgreSQL - Pentesting PostgreSQL Databases and Servers"
description: ""Pentesting PostgreSQL Databases and Servers - Notes"
comments: true
keywords: "security, postgres, database, servers, red team, pentesting"
---

> This is a post holding my notes and other work in progress items and will be updated sporadically.  Last updated 16-12-2020.

The HINT in an ERROR message leaks information http://www.postgresqltutorial.com/plpgsql-errors-messages/

The ERROR message leaks information http://www.postgresqltutorial.com/plpgsql-errors-messages/

DROP index statement http://www.postgresqltutorial.com/postgresql-indexes/postgresql-drop-index/

LIST index statement (which part is reconnaissance though http://www.postgresqltutorial.com/postgresql-indexes/postgresql-list-indexes/)

Being able to find the Postgres version

Being able to query the type of index

Being able to DELETE http://www.postgresqltutorial.com/postgresql-delete/

An attempt was made to DELETE http://www.postgresqltutorial.com/postgresql-delete/

A new role was CREATED
CREATE ROLE username NOINHERIT LOGIN PASSWORD password;
CREATE ROLE role_name;

Roles have been set
GRANT role_2 TO role_1;

Database has been deleted
DROP DATABASE [IF EXISTS] db_name;

A column has been dropped
ALTER TABLE table_name DROP COLUMN column_name;

A table has been dropped
DROP TABLE [IF EXISTS] table_name CASCADE;

How to prevent disaster recovery https://www.postgresql.eu/events/pgconfeu2019/schedule/session/2754-you-forgot-to-put-the-where-in-the-delete/

No data at rest encryption https://www.cybertec-postgresql.com/en/products/postgresql-transparent-data-encryption/

Blocks are decrypted as they are read from disk (side channel attack) https://www.cybertec-postgresql.com/en/products/postgresql-transparent-data-encryption/

Is the database first nitialized with encryption in mind and that the key used for initializing the database is accessible to the server during startup.

The following are not encrypted: https://www.cybertec-postgresql.com/en/products/postgresql-transparent-data-encryption/
 Transport encryption (client / server) via SSL; Encrypted replication; Fully secured replicas

The Client connection to the database is not encrypted (ie SSL)

Active Directory is compromised on the Client side

Postgres SQL injections http://pentestmonkey.net/cheat-sheet/sql-injection/postgres-sql-injection-cheat-sheet

Being able to use WAL to shutdown PostgreSQL https://www.postgresql.org/docs/9.3/continuous-archiving.html (filling up pg_xlog/ directory)

Can you enumerate the postgres details https://pen-testing-lab.blogspot.com/2012/01/brute-forcing-postgres.html (use nmap against metasploitable)

Can you brute force into postgres database https://pen-testing-lab.blogspot.com/2012/01/brute-forcing-postgres.html (use msfconsole and wordlists)

PENTESTER'S GUIDE TO POSTGRES https://hakin9.org/a-penetration-testers-guide-to-postgresql/

METASPLOIT POSTGRESQL SETUP https://fedoraproject.org/wiki/Metasploit_Postgres_Setup

Admin Postgres Auxiliary Modules ON METASPLOIT https://www.offensive-security.com/metasploit-unleashed/admin-postgres-auxiliary-modules/
